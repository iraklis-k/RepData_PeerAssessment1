---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---

## Load and preprocess the data
Read the data file and print the first few lines for inspection. 
```{r}
data <- read.csv("activity.csv")
head(data)
```

There are missing values, so index the vector accordingly. 
```{r}
bad <- is.nan(data$steps)
```

Combine the date and interval variables into an R time object. Since strptime() cannot handle the hhmm format we will need to

1. Add leading zeros to the interval variable, 
1. Split it up into two segments with substr(), 
1. Feed into strptime() as %h%m (but format as POSIXlt), and 
1. Print the top of the array for inspection. 

```{r}
# Four element time format array: 
time <- sprintf('%04i', data$interval)
datetime <- as.POSIXlt(strptime(paste(data$date, 
            substr(time,1,2), substr(time,3,4)), 
            '%Y-%m-%d %H %M', tz="EST5EDT"))
head(datetime)
```

How many days do our data cover? 
```{r}
difftime(tail(datetime, n=1), datetime[1])
```

## What is mean total number of steps taken per day?

First we need to index the array per day. 

```{r}
dayIndex <- seq(datetime[1], to=tail(datetime, n=1), by='day')
head(dayIndex)
```

And now count up the steps by day. A for loop is the quickest way I can think of but there is probably a smarter way. Start a zero vector first. 

```{r}
daySteps <- numeric(length(dayIndex))

for(i in 2:length(dayIndex)) {
    thisDay <- (datetime > dayIndex[i-1] & datetime < dayIndex[i])
    daySteps[i] = sum(data$steps[thisDay], na.rm=TRUE)
}
print(daySteps)
```

**The daily integer mean and median numbers of steps are:**

```{r}
round(mean(daySteps)); round(median(daySteps))
```

Now let's make a histogram with enough breaks to show the NA bar. 

```{r}
hist(daySteps, breaks=18)
```

## What is the average daily activity pattern?

First subset() to sort by time-step (0000, 0005, etc) and get the average according to the interval. 

```{r}
#byInterval <- data$steps[order(data$interval)]

nTimeSteps <- length(unique(data$interval))
avgByInterval <- numeric(length=nTimeSteps)

for(i in 1:nTimeSteps){
    avgByInterval[i] <- mean(subset(data, 
            interval==unique(interval)[i])[[1]], na.rm=TRUE)
}

```

Now plot the average daily activity pattern: 

```{r}
plot(avgByInterval ~ unique(interval), data=data, type='l', 
    xlab='Time of day', ylab='Average steps')
```

That is, break down by day (Mon, Tue...) and produce seven plots. 
```{r}
#mon <- weekdays(datetime) == "Monday"
#tue <- weekdays(datetime) == "Tuesday"
#wed <- weekdays(datetime) == "Wednesday"
#thu <- weekdays(datetime) == "Thursday"
#fri <- weekdays(datetime) == "Friday"
#sat <- weekdays(datetime) == "Saturday"
#sun <- weekdays(datetime) == "Sunday"
#plot(data$interval[mon] ~ data$steps[mon])
```


## Inputing missing values



## Are there differences in activity patterns between weekdays and weekends?

Produce an index of weekends instead of two separate factors. 
```{r}
wkend <- (weekdays(datetime) == "Sunday" | 
            weekdays(datetime) == "Saturday")
```
